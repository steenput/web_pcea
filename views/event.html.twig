{% extends "layout.html.twig" %}

{% block title %}Event {{ event.name }}{% endblock %}

{% block content %}

<h1>Event {{ event.name }}</h1>

<div id="placeholder" style="width:600px;height:300px"></div>

<h2>Spents</h2>
<p><a href="{{ path('new_spent', { 'eventId': event.id }) }}">New spent</a></p>
<table class="table table-bordered table-striped table-condensed">
	<tr>
		<th>Name</th>
		<th>Amount</th>
		<th>Buy date</th>
		<th>Buyer</th>
		<th>Concern</th>
		<th>Your part</th>
	</tr>
	{% for spent in spents %}
	<tr>
		<td>{{ spent.name }}</td>
		<td>{{ spent.amount }}</td>
		<td>{{ spent.buyDate }}</td>
		<td>{{ spent.buyer.username }}</td>
		<td>
			{% for user in spent.users %}
				{% if loop.last %}
					{{ user.username|e }}
				{% else %}
					{{ user.username|e }},
				{% endif %}
			{% endfor %}
		</td>
		<td>{{ spent.part }}</td>
	</tr>
	{% endfor %}
	<tr>
		<td><strong>Total</strong></td>
		<td><strong>{{ grandTotal }}</strong></td>
		<td></td>
		<td></td>
		<td></td>
		<td><strong>{{ total }}</strong></td>
	</tr>
</table>

<h2>Users</h2>
<table class="table table-bordered table-striped table-condensed">
	<tr>
		<th>Username</th>
		<th>Weight</th>
	</tr>
	{% for user in event.users %}
	<tr>
		<td>{{ user.username }}</td>
		<td>{{ user.weight }}</td>
	</tr>
	{% endfor %}
</table>

{% endblock %}


{% block script %}
<script>
	$(function() {
		let data = [ 
			
			["January", 1], ["February", -2], ["March", 4], ["April", 5], ["May", 2], ["June", 3] 
		];

		$.plot("#placeholder", [ data ], {
			series: {
				bars: {
					show: true,
					barWidth: 0.6,
					align: "center",
				},
				color: 2
			},
			xaxis: {
				mode: "categories",
				tickLength: 0
			}
		});
	});
</script>
{% endblock %}